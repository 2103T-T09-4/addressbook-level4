= Car Park Finder - Developer Guide
:site-section: DeveloperGuide
:toc:
:toc-title:
:toc-placement: preamble
:sectnums:
:imagesDir: images
:stylesDir: stylesheets
:xrefstyle: full
ifdef::env-github[]
:tip-caption: :bulb:
:note-caption: :information_source:
:warning-caption: :warning:
:experimental:
endif::[]
:repoURL: https://github.com/CS2103-AY1819S1-T09-4/main

By: `Team T09-4`      Since: `Oct 2018`      Licence: `MIT`

== Setting up

=== Prerequisites

. *JDK `9`* or later
+
[WARNING]
JDK `10` on Windows will fail to run tests in <<UsingGradle#Running-Tests, headless mode>> due to a https://github.com/javafxports/openjdk-jfx/issues/66[JavaFX bug].
Windows developers are highly recommended to use JDK `9`.

. *IntelliJ* IDE
+
[NOTE]
IntelliJ by default has Gradle and JavaFx plugins installed. +
Do not disable them. If you have disabled them, go to `File` > `Settings` > `Plugins` to re-enable them.


=== Setting up the project in your computer

. Fork this repo, and clone the fork to your computer
. Open IntelliJ (if you are not in the welcome screen, click `File` > `Close Project` to close the existing project
dialog first)
. Set up the correct JDK version for Gradle
.. Click `Configure` > `Project Defaults` > `Project Structure`
.. Click `New...` and find the directory of the JDK
. Click `Import Project`
. Locate the `build.gradle` file and select it. Click `OK`
. Click `Open as Project`
. Click `OK` to accept the default settings
. Open a console and run the command `gradlew processResources`
(Mac/Linux: `./gradlew processResources`). It should finish
with the `BUILD SUCCESSFUL` message. +
This will generate all resources required by the application and tests.
. Open link:{repoURL}/src/main/java/seedu/address/storage/XmlAdaptedCarpark.java[`XmlAdaptedCarpark.java`]
and link:{repoURL}/src/main/java/seedu/address/ui/MainWindow.java[`MainWindow.java`] and check for any code errors
.. Due to an ongoing https://youtrack.jetbrains.com/issue/IDEA-189060[issue] with some of the
newer versions of IntelliJ, code errors may be detected even if the project can be built and run successfully
.. To resolve this, place your cursor over any of the code section highlighted in red. Press kbd:[ALT + ENTER],
and select `Add '--add-modules=...' to module compiler options` for each error
. Repeat this for the test folder as well
(e.g. check link:{repoURL}/src/test/java/seedu/address/commons/util/XmlUtilTest.java[`XmlUtilTest.java`]
and link:{repoURL}/src/test/java/seedu/address/ui/HelpWindowTest.java[`HelpWindowTest.java`] for code errors,
and if so, resolve it the same way)

=== Verifying the setup

. Run the `seedu.address.MainApp` and try a few commands
. <<Testing,Run the tests>> to ensure they all pass.

=== Configurations to do before writing code

==== Configuring the coding style

This project follows https://github.com/oss-generic/process/blob/master/docs/CodingStandards.adoc[oss-generic coding standards]. IntelliJ's default style is mostly compliant with ours but it uses a different import order from ours. To rectify,

. Go to `File` > `Settings...` (Windows/Linux), or `IntelliJ IDEA` > `Preferences...` (macOS)
. Select `Editor` > `Code Style` > `Java`
. Click on the `Imports` tab to set the order

* For `Class count to use import with '\*'` and `Names count to use static import with '*'`: Set to `999` to prevent IntelliJ from contracting the import statements
* For `Import Layout`: The order is `import static all other imports`, `import java.\*`, `import javax.*`, `import org.\*`, `import com.*`, `import all other imports`. Add a `<blank line>` between each `import`

Optionally, you can follow the <<UsingCheckstyle#, UsingCheckstyle.adoc>> document to configure Intellij to check style-compliance as you write code.

==== Setting up CI

Set up Travis to perform Continuous Integration (CI) for your fork. See <<UsingTravis#, UsingTravis.adoc>> to learn how to set it up.

After setting up Travis, you can optionally set up coverage reporting for your team fork (see <<UsingCoveralls#, UsingCoveralls.adoc>>).

[NOTE]
Coverage reporting could be useful for a team repository that hosts the final version but it is not that useful for your personal fork.

Optionally, you can set up AppVeyor as a second CI (see <<UsingAppVeyor#, UsingAppVeyor.adoc>>).

[NOTE]
Having both Travis and AppVeyor ensures your App works on both Unix-based platforms and Windows-based platforms (Travis is Unix-based and AppVeyor is Windows-based)

== Implementation

=== Find feature
==== Current implementation
The find mechanism is facilitated by `FindCommand` and `FindCommandParser`. It extends `Command` and implements the following operations.

* `FindCommand#execute()` -- Executes the command by running a predicate `CarparkContainsKeywordsPredicate` and updates the car park list.

The find mechanism is supported by `FindCommandParser`. It implements `Parser` that contains the following operations.

* `FindCommandParser#parse()` -- Checks the arguments for empty strings and throws a `ParseException` if empty string is found. It then splits it by one or more white spaces. It then removes any strings in the list of common words.

The predicate `CarparkContainsKeywordsPredicate` takes in a list of strings and checks if any of the strings contain fully or partial in the list of car park names or address, and returns the car park if so.

Given below is an example usage scenario and how the Find mechanism behaves at each step.

Step 1. The user launches the application for the first time.

Step 2. The user executes `find punggol` command to get all car park in punggol.
The `find` command calls `FindCommandParser#parse()`, checking the values `punggol`.

[NOTE]
If a command fails its execution, it will not call `FindCommand#execute()`, so the address book state will not be saved.

Step 3. The entire list of car park is filtered by the predicate `CarparkContainsKeywordsPredicate`.

Step 4. The filtered list of car park is returned to the GUI.
=======

== Implementation

=== Command alias feature

==== Current Implementation

The alias mechanism is facilitated by `AddressBookParser`. It extends the cases
when shorter command words are parsed through `parseCommand`.

Given below is an example usage scenario and how the alias mechanism behaves at
each step.

Step 1. The user launches the application for the first time. The `LogicManager`
will be initialized with an `AddressBookParser`.

Step 2. The user executes `l` command instead of `list`. The `Matcher` object in
`AddressBookParser` splits the command text into **command word ** section and
*arguments,* section of which the **command word **is parsed using a _<switch>_
statement. The *command word* will be matched to case of `COMMAND_ALIAS` from
`ListCommand`, which holds the final value of 'l'. The program finds a match and
proceeds as if a `list` command is given.

The following activity diagram summarizes what happens when a user executes a `l`
command:

image::AliasActivityDiagram.jpg[width="700", align="left"]

==== Designer Considerations

* *Alternative 1 (current choice):* declare `COMMAND_ALIAS` with a string value
in each Command file.
** *Pros:* Easy to implement
** *Cons:* Have to decide the alias subjectively which brings down performance
if there are alot of commands

* *Alternative 2:* declare `COMMAND_ALIAS` using the first two chars of `COMMAND_WORD`
in each Command file.
** *Pros*: Better performance as alias will be assigned systematically.
** *Cons*: When there are 2 command words starting with same 2 chars e.g. `find`
& `filter`, it does not work.

[appendix]
== Product Scope

*Target user profile*:

* commutes using a car and needs to find an empty parking lot
* wants to know specific details of a car park in a certain location
* prefers desktop apps over other types
* can type fast
* prefers typing over mouse input
* is reasonably comfortable using CLI apps

*Value proposition*: helping busy car owners to plan their trip by getting details
of nearby car parks from their destination in a fast and efficient manner

[appendix]
== User Stories

Priorities: High (must have) - `* * \*`, Medium (nice to have) - `* \*`, Low (unlikely to have) - `*`

=== Filter and Sorting - Yurou

[width="59%",cols="22%,<23%,<25%,<30%",options="header",]
|=======================================================================
|Priority |As a ... |I want to ... |So that I can...
|`* * *` |car owner |know how far away my destination is from the car park
|find the shortest walking distance to my destination

|`* *` |driver |find out how much is the parking fee |calculate the cost of parking at the car park

|`* *` |driver |find out the types of parking available at the car park
|decide if I can park and leave my car there
|=======================================================================

=== Search and Flag - Keith

[width="59%",cols="22%,<23%,<25%,<30%",options="header",]
|=======================================================================
|Priority |As a ... |I want to ... |So that I can...
|`* * *` |car owner |know more details about the car park and its lots
|decide where to go depending on the information provided

|`* * *` |driver |find a list of available parking lots within my destination
|plan which car park location is convenient for me

|`* *` |car owner |search by details of a car park |view information about a car park that I want
|=======================================================================

=== Store and Load Favorites - Alvin

[width="59%",cols="22%,<23%,<25%,<30%",options="header",]
|=======================================================================
|Priority |As a ... |I want to ... |So that I can...
|`* *` |car owner |have a list of destinations that I visit often
|save time as I do not have to retype my commands

|`* *` |user |add a car park to my favorites
|create an organised list of preferred car parks

|`* *` |user |view my favorite list with ease at the start
|glance through the car parks without using commands

|`* *` |user |save a list of destinations like a favorite list
|add and keep track of preferred car parks

|`* *` |user |edit and write remarks about car parks in my favorite list
|add or update new information about specific car parks

|`* *` |user |delete car parks from my favorites
|remove car parks that are no longer of my interest
|=======================================================================

=== API and Notifications - Zhuan Yu

[width="59%",cols="22%,<23%,<25%,<30%",options="header",]
|=======================================================================
|Priority |As a ... |I want to ... |So that I can...
|`* * *` |car owner |receive notifications about car park availability
|save time and plan my trip accordingly to vacancy of parking lots

|`* *` |driver |set how frequent to notify me about more suitable car parks
|change which car park I am headed to without searching again

|`* *` |driver |know if the car park is changed to fully occupied
|go to another car park that is not full

|`* *` |driver |check the current weather forecast at destination
|plan ahead if the car park has no shelter and move to one that has it
|=======================================================================

=== Cache and Aliases - Delong

[width="59%",cols="22%,<23%,<25%,<30%",options="header",]
|=======================================================================
|Priority |As a ... |I want to ... |So that I can...
|`* * *` |new user |learn how to use the application easily
|spend less time on learning and more on using it

|`* * *` |new user |be able to understand the UI without much instruction
|spend my time on the program using the features

|`* *` |user |use shorthand equivalent alias of commands
|navigate the application in a more time efficient way

|`*` |user |autocomplete my requests
|get the information that I want faster
|=======================================================================

[appendix]
== Use Cases

(For all use cases below, the *System* is the `Car Park Finder` and the *Actor* is the
`user / driver / car owner`, unless specified otherwise)

=== Filter and Sorting - Yurou

[discrete]
==== Use case: UC01 - Filter car park

*MSS*

1.  *Actor* requests a list of car parks
2.  *System* shows a list of car parks
3.  *Actor* requests to [.underline]#filter the list of car parks using flags *(UC05)*#
4.  *System* shows a new filtered list of car parks
+
Use case ends.

*Extensions*

[none]
* 2a. The list is empty.
+
Use case ends.

* 3a. The given flags are invalid.
+
[none]
** 3a1. *System* shows an error message.
+
Use case resumes at step 2.

* 3b. No input for flags.
+
[none]
** 3b1. *System* will show a list of car parks with all the flags selected.
+
Use case ends.

[discrete]
==== Use case: UC02 - Sort car park

*MSS*

1.  *Actor* requests a list of car parks
2.  *System* shows a list of car parks
3.  *Actor* requests to sort the list of car parks base on distance
4.  *System* shows a new sorted list of car parks
+
Use case ends.

*Extensions*

[none]
* 2a. The list is empty.
+
Use case ends.

* 3a. The given distance is invalid.
+
[none]
** 3a1. *System* shows an error message.
+
Use case resumes at step 2.

* 3b. No input for distance.
+
[none]
** 3b1. *System* will use the default distance to sort the list of car parks.
+
Use case ends.

[discrete]
==== Use case: UC03 - Calculate parking fee

*MSS*

1.  *Actor* requests a list of car parks
2.  *System* shows a list of car parks
3.  *Actor* requests to calculate the cost of parking at a car park given a duration
4.  *System* shows the amount to pay for that car park
+
Use case ends.

*Extensions*

[none]
* 2a. The list is empty.
+
Use case ends.

* 3a. The given car park number is invalid.
+
[none]
** 3a1. *System* shows an error message.
+
Use case resumes at step 2.

* 3b. No input for duration.
+
[none]
** 3b1. *System* will use the default duration to calculate the cost.
+
Use case ends.

* 3c. The given duration is invalid.
+
[none]
** 3c1. *System* shows an error message.
+
Use case ends.

=== Search and Flag - Keith

[discrete]
==== Use case: UC04 - Search car park

*MSS*

1.  *Actor* requests a list of car parks near the destination
2.  *System* shows a list of car parks
3.  *Actor* requests to [.underline]#filter the list of car parks using flags *(UC05)*#
4.  *System* shows a new filtered list of car parks
+
Use case ends.

*Extensions*

[none]
* 1a. The destination is invalid.
+
[none]
** 1a1. *System* shows an error message.
+
Use case ends.

[none]
* 2a. The list is empty.
+
Use case ends.

* 3a. The given flags are invalid.
+
[none]
** 3a1. *System* shows an error message.
+
Use case resumes at step 2.

* 3b. No input for flags.
+
[none]
** 3b1. *System* will show a list of car parks with all the flags selected.
+
Use case ends.

[discrete]
==== Use case: UC05 - Flag car park details

Preconditions: *Actor* already requested a list of car parks

*MSS*

1.  *Actor* sets the flags to indicate the required car park details
2.  *System* shows a list of car parks with the selected flags
+
Use case ends.

*Extensions*

[none]
* 1a. The given flags are invalid.
+
[none]
** 1a1. *System* shows an error message.
+
Use case resumes before step 1.

* 1b. No input for flags.
+
[none]
** 1b1. *System* will show a list of car parks with all the flags selected.
+
Use case ends.

=== Store and Load Favourites - Alvin

[discrete]
==== Use case: UC06 - Add car park to Favourites

*MSS*

1.  *Actor* requests to list car parks
2.  *System* shows a list of car parks
3.  *Actor* requests to add a specific car park to the favourites list
4.  *System* adds the car park
+
Use case ends.

*Extensions*

[none]
* 3a. The given index to add invalid.
+
[none]
** 3a1. *System* shows an error message.
+
Use case resumes at step 2.

[discrete]
==== Use case: UC07 - Delete car park in Favourites

*MSS*

1.  *Actor* requests to list car parks
2.  *System* shows a list of car parks
3.  *Actor* requests to delete a specific car park in the favourites list
4.  *System* deletes the car park
+
Use case ends.

*Extensions*

[none]
* 2a. The favourites list is empty.
+
[none]
** 2a1. *System* shows a message.
+
Use case ends.

* 3a. The given index to delete is invalid.
+
[none]
** 3a1. *System* shows an error message.
+
Use case resumes at step 2.

[discrete]
==== Use case: UC08 - List Favourites

*MSS*

1.  *Actor* requests to list favourites
2.  *System* shows a list of car parks
+
Use case ends.

*Extensions*

[none]
* 1a. The favourites list is empty.
+
[none]
** 1a1. *System* shows a message.
+
Use case ends.

[discrete]
==== Use case: UC09 - Tags and remarks

*MSS*

1.  *Actor* requests to list favourites
2.  *System* shows a list of car parks
3.  *Actor* requests to modify tags and remarks to the car parks
4.  *System* shows favourites with the new changes
+
Use case ends.

*Extensions*

[none]
* 1a. The favourites list is empty.
+
[none]
** 1a1. *System* shows a message.
+
Use case ends.

* 3a. Tags and remarks are invalid.
+
[none]
** 3a1. *System* shows an error message.
+
Use case resumes at step 2.

=== API and Notifications - Zhuan Yu

[discrete]
==== Use case: UC10 - Receive notifications
Preconditions: *Actor* already requested a list of car parks

*MSS*

1.  *Actor* requests to be notified at regular intervals
2.  *System* shows the car park availability every interval
+
Use case ends.

*Extensions*

[none]
* 1a. The given time to notify is invalid.
+
[none]
** 1a1. *System* shows an error message.
+
Use case resumes before step 1.

* 1b. No input for timing.
+
[none]
** 1b1. *System* will use the default interval to notify.
+
Use case resumes at step 2.

* 2a. Unable to retrieve car park availability.
+
[none]
** 2a1. *System* shows an error message.
+
Use case ends.

[discrete]
==== Use case: UC11 - Car park fully occupied
Preconditions: *Actor* already selected a car park from the list

*MSS*

1.  *System* shows the car park is now fully occupied
2.  *Actor* requests to list car parks again
3.  *System* shows a list of car parks
4.  *Actor* requests to select a new car park
+
Use case ends.

*Extensions*

[none]
* 3a. Unable to retrieve car park availability.
+
[none]
** 3a1. *System* shows an error message.
+
Use case ends.

[discrete]
==== Use case: UC12 - Weather update
Preconditions:

* *Actor* already selected a car park from the list
* *System* already showed weather forecast of the area

*MSS*

1.  *Actor* requests to update weather conditions
2.  *System* shows the current weather forecast of the area
+
Use case ends.

*Extensions*

[none]
* 2a. Unable to retrieve weather forecast.
+
[none]
** 2a1. *System* shows an error message.
+
Use case ends.

=== Cache and Aliases - Delong

[discrete]
==== Use case: UC13 - View instructions

*MSS*

1.  *Actor* requests help in learning the application
2.  *System* shows a list of commands with information about each one of them
+
Use case ends.

*Extensions*

[none]
* 1a. Wrong command input
+
[none]
** 1a1. *System* shows the list of commands
+
Use case ends.

[discrete]
==== Use case: UC14 - Command alias

*MSS*

1.  *Actor* requests using alias for the commands
2.  *System* understands the command and proceeds to process it
+
Use case ends.

*Extensions*

[none]
* 1a. Alias not accepted
+
[none]
** 1a1. *System* shows the list of commands
+
Use case ends.

[discrete]
==== Use case: UC15 - Autocomplete command

*MSS*

1.  *Actor* beings typing in the command
2.  *System* recognises the command and does autocomplete
3.  *Actor* selects the autocomplete word
+
Use case ends.

[appendix]
== Non Functional Requirements

. Should work on any <<mainstream-os,mainstream OS>> as long as it has Java `9` or higher installed.
. Should not have any noticeable sluggishness when holding list of car parks.
. Should come with automated unit tests and be able to handle errors and exceptions.
. Should be easy to use for novice that have never used a CLI before or never used an application
to search for locations of car parks.
. Query should respond fast assuming no connection delays and the API is working.
. The application is not expected to download an entire list of car parks in the country to work offline.
. This application is not suppose to be used by drivers on the road.
. The system should be easy and scalable in adding on features for future versions.
. The car park data should be updated frequently while running to send notifications in real time.
. Privacy details in the user profile should not be seen or shared easily by others.

[appendix]
== Glossary

[[api]] API (Application Programming Interface)::
A set of functions and procedures that allow the creation of applications which access the features or data of an operating system, application, or other service.

[[autocomplete]]  Autocomplete::
Provides suggestions while you type into the field

[[flag]] Flag::
A value that acts as a signal for a function or process.

[[mainstream-os]] Mainstream OS::
Windows, Linux, Unix, OS-X

[[private-contact-detail]] Favourites::
A custom list of car parks that is meant to be viewed easily

[appendix]
== Product Survey

*Product Name*

Author: ...

Pros:

* ...
* ...

Cons:

* ...
* ...

[appendix]
== Instructions for Manual Testing

Given below are instructions to test the app manually.

[NOTE]
These instructions only provide a starting point for testers to work on; testers are expected to do more _exploratory_ testing.

=== Launch and Shutdown

. Initial launch

.. Download the jar file and copy into an empty folder
.. Double-click the jar file +
   Expected: Shows the GUI with a set of sample contacts. The window size may not be optimum.

. Saving window preferences

.. Resize the window to an optimum size. Move the window to a different location. Close the window.
.. Re-launch the app by double-clicking the jar file. +
   Expected: The most recent window size and location is retained.

_{ more test cases ... }_

=== Deleting a car park

. Deleting a car park while all carparks are listed

.. Prerequisites: List all car parks using the `list` command. Multiple car parks in the list.
.. Test case: `delete 1` +
   Expected: First contact is deleted from the list. Details of the deleted contact shown in the status message. Timestamp in the status bar is updated.
.. Test case: `delete 0` +
   Expected: No car park is deleted. Error details shown in the status message. Status bar remains the same.
.. Other incorrect delete commands to try: `delete`, `delete x` (where x is larger than the list size) _{give more}_ +
   Expected: Similar to previous.

_{ more test cases ... }_

=== Saving data

. Dealing with missing/corrupted data files

.. _{explain how to simulate a missing/corrupted file and the expected behavior}_

_{ more test cases ... }_
